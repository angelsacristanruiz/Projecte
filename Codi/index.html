<!DOCTYPE html>
<html>
	<head><meta charset="euc-jp">
		<title></title>
		<link href="estilo.css" rel="stylesheet" type="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1"><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
	</head>
	<body>
		<div class="container">
			<div class="info">
				<h1>Gesti&oacute; d&#39;horaris</h1>
			</div>
		</div>

		<div class="form">
			<div class="thumbnail">
				<img src="logo.png"/>
			</div>

			<form class="login-form" id="formulario" name="formulario" onsubmit="registra(); return false">
				<div id="quitar">
					<input id="usuari" placeholder="Nom d'usuari" required="" type="text"/>
					<input id="contrasenya" placeholder="Contrasenya" required="" type="password"/><br/>
					<textarea id="comentari" placeholder="Comentari opcional"></textarea><br/>
			&nbsp;
					<div id="separa1">
						<input id="entrada" name="opcion" required="" type="radio" value="Entrada" />
						<label for="entrada">Entrada</label>
					</div>

					<div id="separa2">
						<input id="salida" name="opcion" required="" type="radio" value="Sortida" />
						<label for="salida">Sortida</label>
					</div>
					<button>Enviar</button>
				</div>

				<div id="poner">
					<textarea id="muestra"> </textarea>
				</div>
			</form>
		</div>
	</body>
		<script type="text/javascript">
			  var usuarios = ["almendra","test1","fbodego", "asacristan","gbombardo","eva.garell","raguilera","obalmes","ccabezon","mdenadal","mdominguez","floidi","eferrandiz","rferrero","mfolch","dgiro","mgonzalez","dgonzalez","ogrodniewicz","llguilera","ggutierrez","dhernandez","chernando","slamas","amanach","jmartin","tmartin","nmonter","amoreno","fperal","mperez","aprat","epuig","mrabassa","broig","arubio","eruiz","csantamaria","asalvo","mtorrento","atrias","lurbano","lvila","imerino","mcecuk","msforrellat","obeltran","lvigo","mdemedeiros","mnikolic","dborrell","iargelich","nmuzaffar","gcarreras","calonso","llam"];
			  var contraseñas = ["almendra","test1","123","456","gbombardo8359","eva.garell4379","r6746","o8732","c6537","m8342","m5874","f9854","e6743","r7454","m8434","d1435","m7687","d9823","o7362","ll8736","g7854","d4574","c8934","s8745","a5874","pacheco","t8493","n8734","a8965","f8547","m7634","a9876","e8732","m7643","b7647","a5673","e2342","c3453","a9842","m6537","a7897","l9876","l8724","i7544","m6789","m3465","b7645","l6541","m9461","m2711","d3164","i4152","n7067","g6731","c6752","l9745"];
			  var indiceNombre = -1;
			  var indiceContrasenya = -2;

			  function registra() {
				  if (document.getElementById("usuari").value == null || document.getElementById("contrasenya").value == null || getRadioButtonSelectedValue(formulario.opcion) == null) {
					  alert("Falten dades");
				  } else {

					  var usuario = document.getElementById("usuari").value;
					  usuarios.forEach(function (valor, indice, array) {
						  if (usuario == valor) {
							  indiceNombre = indice;
						  }
					  });

					  var contrasenya = document.getElementById("contrasenya").value;
					  contraseñas.forEach(function (valor, indice, array) {
						  if (contrasenya == valor) {
							  indiceContrasenya = indice;
						  }
					  });

					  if (indiceNombre == indiceContrasenya) {

						  var hacer = getRadioButtonSelectedValue(formulario.opcion);
						  var fecha = new Date();
						  var comentario = document.getElementById("comentari").value;

						  var param = {
							  nombre: document.getElementById("usuari").value,
							  hacer: getRadioButtonSelectedValue(formulario.opcion),
							  dia: fecha.getDate(),
							  mes: fecha.getMonth()+1,
							  ano: fecha.getFullYear(),
							  horas: fecha.getHours(),
							  minutos: fecha.getMinutes(),
							  segundos: fecha.getSeconds(),
							  comentari: document.getElementById("comentari").value
						  };

						  $.ajax({
							  data: param,
							  url: "guardar.php",
							  method: "post",
							  success: function (data) {
								  document.getElementById("poner").innerHTML = data;
							  }
						  });

						  document.getElementById("quitar").style.display = "none";
						  document.getElementById("poner").style.display = "block";

					  } else {
						  alert("Usuari incorrecte");
					  }
				  }
			  }

			  function getRadioButtonSelectedValue(ctrl)
			  {
				  for(i=0;i<ctrl.length;i++)
					  if(ctrl[i].checked) return ctrl[i].value;
			  }


		</script>
</html>
